<!DOCTYPE html><html lang="pt-br" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Detecção de Bordas" /><meta property="og:locale" content="pt_br" /><meta name="description" content="Detecção de Bordas A visão computacional é uma área da ciência que desenvolve teorias e tecnologias como objetivos de extrair informações de dados multidimensionais. Quase sempre, recorremos a uma analogia de como nós detectamos e reconhecemos objetos. Um objeto é caracterizado por conjuntos de atributos como: cor, texturas e forma geométrica. Nesse sentido, a extração de contorno poder representar informações importantes sobre um determinado objeto. Por exemplo, podemos identificar diversas formas geométricas como retângulo circulo, triângulos, linhas e outros. Além do que os médoto de detecção não utilizam muito recurso computacional sendo uma técnica atraente para aplicação em sistemas embaracados." /><meta property="og:description" content="Detecção de Bordas A visão computacional é uma área da ciência que desenvolve teorias e tecnologias como objetivos de extrair informações de dados multidimensionais. Quase sempre, recorremos a uma analogia de como nós detectamos e reconhecemos objetos. Um objeto é caracterizado por conjuntos de atributos como: cor, texturas e forma geométrica. Nesse sentido, a extração de contorno poder representar informações importantes sobre um determinado objeto. Por exemplo, podemos identificar diversas formas geométricas como retângulo circulo, triângulos, linhas e outros. Além do que os médoto de detecção não utilizam muito recurso computacional sendo uma técnica atraente para aplicação em sistemas embaracados." /><link rel="canonical" href="/posts/cap1/" /><meta property="og:url" content="/posts/cap1/" /><meta property="og:site_name" content="Grupo OpenCV BR" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-04T08:25:34-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Detecção de Bordas" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-01-02T23:10:26-03:00","datePublished":"2020-12-04T08:25:34-03:00","description":"Detecção de Bordas A visão computacional é uma área da ciência que desenvolve teorias e tecnologias como objetivos de extrair informações de dados multidimensionais. Quase sempre, recorremos a uma analogia de como nós detectamos e reconhecemos objetos. Um objeto é caracterizado por conjuntos de atributos como: cor, texturas e forma geométrica. Nesse sentido, a extração de contorno poder representar informações importantes sobre um determinado objeto. Por exemplo, podemos identificar diversas formas geométricas como retângulo circulo, triângulos, linhas e outros. Além do que os médoto de detecção não utilizam muito recurso computacional sendo uma técnica atraente para aplicação em sistemas embaracados.","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/cap1/"},"url":"/posts/cap1/","@type":"BlogPosting","headline":"Detecção de Bordas","@context":"https://schema.org"}</script><title>Detecção de Bordas | Grupo OpenCV BR</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grupo OpenCV BR"><meta name="application-name" content="Grupo OpenCV BR"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grupo OpenCV BR</a></div><div class="site-subtitle font-italic">Espalhando a Palavra da Visão Computacional</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Grupo-OpenCV-BR" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Detecção de Bordas</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Detecção de Bordas</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Grupo OpenCV Brasil</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2020-12-04 08:25:34 -0300" data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 4, 2020, 8:25 AM -0300" >Dec 4, 2020</em> </span> <span> Updated <em class="timeago" date="2022-01-02 23:10:26 -0300 " data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 2, 2022, 11:10 PM -0300" >Jan 2</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1127 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="detecção-de-bordas">Detecção de Bordas</h1><p>A visão computacional é uma área da ciência que desenvolve teorias e tecnologias como objetivos de extrair informações de dados multidimensionais. Quase sempre, recorremos a uma analogia de como nós detectamos e reconhecemos objetos. Um objeto é caracterizado por conjuntos de atributos como: cor, texturas e forma geométrica. Nesse sentido, a extração de contorno poder representar informações importantes sobre um determinado objeto. Por exemplo, podemos identificar diversas formas geométricas como retângulo circulo, triângulos, linhas e outros. Além do que os médoto de detecção não utilizam muito recurso computacional sendo uma técnica atraente para aplicação em sistemas embaracados.</p><p>Nessa capítulo vamos conhecer a base dos algoritmos de detecção de borda e aplicar o algoritmo de Canny.</p><h4 id="dependências">Dependências<a href="#dependências" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Para executar os scripts mostrado aqui, você precisará ter em sua máquina uma versão do python 3 e o OpenCV instalados.</p><ul><li>python3<li>OpenCV</ul><h3 id="o-que-é-uma-borda">O que é uma borda?<a href="#o-que-é-uma-borda" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Uma borda á caracteriza por uma variação abrupta entre os pixels vizinhos de uma imagem.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 250'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/img_linha.png" width="400" height="250" data-proofer-ignore/></div><p align="center"> <b>Figura 1:</b> Pista de corrida</p><p>Primeiro vamos analizar apenas na linha selecionada Figura 1, podemos representa-la por uma função I(x) cujo domínio é uma lista [254,254,173,138,79,44,45,53]</p><p>Como nossa função é discreta (só admite valor inteiro) não podemos calcular diretamente a derivada dessa função mais podemos fazer uma boa aproximação.</p><p>A derivada é uma operação matemática que permite calcular a taxa de variação de uma função ou de dois pontos muito próximos. Ela é definida pela equação 1.</p><div class="image-container" style="display: flex; justify-content: center;"> <img data-src="https://render.githubusercontent.com/render/math?math=\Large{\frac{df}{dx}=\lim_{h\to 0} \frac{f(x %2B h)- f(x)}{h}} " data-proofer-ignore/></div><p align="center"> <b>Equção 1: </b> Derivada.</p><p>Supondo que x seja a posição que estamos na lista, então f(x) é o valor do pixel e f(x+h) é próximo pixel. Acontece que, quando o intervalo h for muito pequeno vamos pegar variações decorreste de ruídos na imagem. sendo assim, não vamos preocupar em fazer pequenos ajustes nesse sentido. Por exemplo, podemo dizer que nossa derivada no ponto x é dada por f(x+h)-f(x-h), ou seja, a diferença do próximo pixel pelo pixel anterior ao ponto x.</p><div class="image-container" style="display: flex; justify-content: center;"> <img data-src="https://render.githubusercontent.com/render/math?math=\Large{\frac{dI}{dx}=I(x %2B 1)-I(x-1)} " data-proofer-ignore/></div><p align="center"> <b>Equação 2: </b> Derivada aproximada.</p><p>Desconsideramos a divisão por h da Equação 1, porque nesse contexto ele é apenas um normalizador da função, ou seja, ele será um parâmetro que vamos passar ao realizar os cálculos.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 50'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/gride1d.png" width="300" height="50" data-proofer-ignore/></div><p align="center"> &lt;<b>Figura 2: </b> Derivada aproximada para 1.</p><p>Um dos motivos da aproximação de fizemos é por conta dos ruídos, porém essa nova equação pode ser representada por um kernel. Computacionalmente é mais interessante convolver um kernel por uma imagem do que aplicar uma função.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 50'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/kernel1d.png" width="300" height="50" data-proofer-ignore/></div><p align="center"> <b>Figura 3: </b> Kernel para calculo de derivada.</p><p>Na Figua 4 realizamos essa operação para toda a linha da imagem 1, tente identificar onde está a região que selecionamos.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 350'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/df.png" width="500" height="350" data-proofer-ignore/></div><p align="center"> <b>Figura 4: </b> Grafico de linha da selecionada na figura 1.</p><p>A lista começa com valor alto, 254 decai ate 44 e sobe novamente para 53. Essa variação acontece no intervalo 160 à 178 (aproximado) do eixo x.</p><p>Se expandirmos esse ideia para um plano 2D nossa função anterior pode ser descrita da seguinte forma.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/grade2d.png" width="300" height="200" data-proofer-ignore/></div><p align="center"> <b>Figura 5: </b> Aproximação de derivada.</p><p>Agora temos derivadas parciais. Da mesma forma, podemos rescrever isso por um kernel.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 450 180'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/kernel2D.png" width="450" height="180" data-proofer-ignore/></div><p align="center"> <b>Figura 6: </b> Kernel para derivada parcial.</p><p>Esse par de kernel na Figura 6 tem o nome de operador Sobel. O OpenCV tem esse operador implementado aqui <a href="https://docs.opencv.org/3.4/d4/d86/group__imgproc__filter.html#gacea54f142e81b6758cb6f375ce782c8d">cv2.sobel</a>, então vamos usar.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">cv2</span>
<span class="n">ddepth</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">CV_16S</span>
<span class="c1"># Carrega imagen "frame.png" em escala de cinza
</span><span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">"frame.png"</span><span class="p">,</span><span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span>
<span class="c1"># calcula derivada de primeira ordem na direção x 
</span><span class="n">grad_x</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">Sobel</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">ddepth</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># calcula derivada de primieira ordem na direção y
</span><span class="n">grad_y</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">Sobel</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">ddepth</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># calcula valor absoluto e converte para uint8 
</span><span class="n">abs_grad_x</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">grad_x</span><span class="p">)</span>
<span class="n">abs_grad_y</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">grad_y</span><span class="p">)</span>

<span class="c1"># Calcula gradiente
</span><span class="n">grad</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">abs_grad_x</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">abs_grad_y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># concatena image gerada com a original
</span><span class="n">saida</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">hconcat</span><span class="p">((</span><span class="n">grad</span><span class="p">,</span><span class="n">gray</span><span class="p">))</span>
<span class="c1"># redimenciona em 60%
</span><span class="n">saida</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">saida</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>
<span class="c1">#salva imagem
</span><span class="n">cv2</span><span class="p">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s">"saida.png"</span><span class="p">,</span><span class="n">saida</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"janela"</span><span class="p">,</span> <span class="n">saida</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 250'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/saida_sobel.png" width="500" height="250" data-proofer-ignore/></div><p align="center"> <b>Figura 7: </b> Resultado do Sobel.</p><p>Perceba que aplicamos o operador Sobel duas vezes, primeiro na direção x e depois na direção y. A composição dessas derivadas é matematicamente conhecida como gradiente. O gradiente é um vetor que aponta na direção onde a função tem a maior variação. No entanto, o que nos interessa aqui é magnitude desse gradiente, ou seja, o quão abrupta é essa variação. O módulo do gradiente poder ser calulado usando a Equação 2 (calculamos com a função cv2.addWeighted).</p><div class="image-container" style="display: flex; justify-content: center;"> <img data-src="https://render.githubusercontent.com/render/math?math=G=\sqrt{{(G_x)^2} %2B {(G_y)^2}}" data-proofer-ignore/></div><p align="center"> <b>Equação 3: </b> Magnitude do gradiente.</p><p>O Sobel é uma das operações mais relevantes para detectar contorno em imagens. Embora exista alternativas como cv2.Scharr que tem uma aproximação melhor da derivada. O Sobel ainda é um dos principais métodos empregados nos algoritmos para detecção de borda.</p><h1 id="algoritmo-de-canny">Algoritmo de Canny</h1><p>O algoritmo de Canny executa vários estágio para detectar uma borda.</p><h4 id="1-remoção-de-ruídos">1. remoção de ruídos.<a href="#1-remoção-de-ruídos" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Na Figura 4, o gráfico da derivada apresenta bastante ruido, isso acontece porque pegamos micros variações locais. Canny usa um filtro gaussiano para resolver isso. Veja como o filtro afeta a derivada na Figura 8.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 350'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/gauss.gif" width="500" height="350" data-proofer-ignore/></div><p align="center"> <b>Figura 8: </b> Efeito de filtro gaussiano.</p><h4 id="2-calcular-gradientes">2. Calcular gradientes.<a href="#2-calcular-gradientes" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>O filtro Sobel discutido no tópico anterior é usado aqui para calcular os gradientes.</p><h4 id="3-máximos-locais">3. Máximos locais.<a href="#3-máximos-locais" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Nessa etapa uma varredura completa é realizada na imagem em busca de gradientes máximos locais, esse processo elemina bordas largas ou duplicadas.</p><h4 id="4-limiar-de-hesterese">4. Limiar de hesterese.<a href="#4-limiar-de-hesterese" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Tudo que esta abaixo de minVal é descartado. o que esta entre minVal e maxVal é mantido apenas se parte do contorno estiver acima de maxVal. Na Figura 9, A é mantido porque esta acima de maxVal, C é mantido, embora esteja abaixo de maxVal ele esta conectado a A. Já o B é removido, pois esta totalmente dentro da área delimitada.</p><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 350'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/grafico_maxval.png" width="500" height="350" data-proofer-ignore/></div><p align="center"> <b>Figura 9: </b>Região delimitada pelos liminar maxVal e minVal.</p><p align="center">Fonte: <url>https://docs.opencv.org/master/da/d22/tutorial_py_canny.html</url></p><h3 id="usando-canny">Usando Canny<a href="#usando-canny" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>No OpenCV temos uma implementação do algoritmo de Canny, o segundo e o terceiro parâmetros passados, são minVal e maxVal.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">cv2</span>
<span class="c1"># Carrega imagem em escala de cinza
</span><span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">'frame.png'</span><span class="p">,</span><span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span>
<span class="c1"># aplica algoritmo de Canny com minVal=100 e maxVal=200
</span><span class="n">edges</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">Canny</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="c1"># concatena imagem original com o resultado
</span><span class="n">saida</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">hconcat</span><span class="p">((</span><span class="n">gray</span><span class="p">,</span><span class="n">edges</span><span class="p">))</span>
<span class="c1">#redimenciona 
</span><span class="n">saida</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">saida</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>
<span class="c1">#Mostra saida
</span><span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"janela"</span><span class="p">,</span><span class="n">saida</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">()</span>
</pre></table></code></div></div><div class="image-container" style="display: flex; justify-content: center;"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 250'%3E%3C/svg%3E" data-src="/assets/img/imagens/cap1/saida_canny.png" width="500" height="250" data-proofer-ignore/></div><p align="center"> <b>Figura 9: </b> Resultado do Canny.</p><p>Aqui deixo um vídeo com animação gráfica do que discutimos nesse artigo.</p><p><a href="https://www.youtube.com/watch?v=DNIQdUHHB7A&amp;feature=youtu.be&amp;ab_channel=eltonfernando&quot;"><img data-src="/assets/img/imagens/cap1/yutub.png" alt="Everything Is AWESOME" data-proofer-ignore/></a></p><h2 id="conclusão">Conclusão<a href="#conclusão" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>De fato, a área de visão computacional é permeada por aplicações matemáticas de alta complexidade. No entanto, bibliotecas como OpenCV tem simplificado, permitindo que pessoas de diversas áreas desenvolva suas própias aplicações. Se você gostou desse assunto, junte-se a nós no grupo opencvBrasil <a href="https://t.me/opencvBrasil"><img data-src="https://logospng.org/download/telegram/logo-telegram-512.png" alt="telegram logo" width="24" data-proofer-ignore/></a>.</p><p><strong>Atenciosamente</strong></p><p><a href="https://www.linkedin.com/in/eltonfernandesdossantos/">Elton fernandes dos Santos</a></p><p>Engenheiro eletricista pela UNEMAT e mestrando em Zootecnia na Universidade Federal do Mato Grosso UFMT.</p><p>Autor do blog <a href="http://www.visioncompy.com">visioncompy</a></p><h2 id="referências">Referências<a href="#referências" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="table-wrapper"><table><tr><td> Documentação oficial OpenCV v 4.5.0: Sobel. fonte https://docs.opencv.org/master/d2/d2c/tutorial_sobel_derivatives.html<tr><td> Documentação oficial OpenCV v 4.5.0: Algoritmo de Canny. fonte https://docs.opencv.org/master/da/d22/tutorial_py_canny.html</table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/canny/'>canny</a>, <a href='/categories/bordas/'>bordas</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Detecção de Bordas - Grupo OpenCV BR&url=/posts/cap1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Detecção de Bordas - Grupo OpenCV BR&u=/posts/cap1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Detecção de Bordas - Grupo OpenCV BR&url=/posts/cap1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/VCPKG_como_usar/">VCPKG, como usar ?</a><li><a href="/posts/capturando_dados_kinect/">Aquisição de dados usando o Sensor Kinect do Xbox 360</a><li><a href="/posts/como_contribuir/">Como contribuir neste Blog</a><li><a href="/posts/cap1/">Detecção de Bordas</a><li><a href="/posts/cap2/">Processamento Morfológico de Imagens</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/getting-started/">getting started</a> <a class="post-tag" href="/tags/kinect-libfreenec-c/">kinect libfreenec c++</a> <a class="post-tag" href="/tags/vcpkg-windows-c/">vcpkg windows c++</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/VCPKG_como_usar/"><div class="card-body"> <em class="timeago small" date="2022-03-05 21:18:34 -0300" >Mar 5</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>VCPKG, como usar ?</h3><div class="text-muted small"><p> Antes de tudo, o que é VCPKG ? Te respondo , é um gerenciador de pacotes tal como Pip (Python) ou Maven (Java) para o C++, que carecia de um gerenciador tão poderoso como esse. Criado pela Micros...</p></div></div></a></div><div class="card"> <a href="/posts/capturando_dados_kinect/"><div class="card-body"> <em class="timeago small" date="2022-02-03 21:14:34 -0300" >Feb 3</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Aquisição de dados usando o Sensor Kinect do Xbox 360</h3><div class="text-muted small"><p> Neste artigo trago um rápido tutorial para que você possa começar a utilizar o sensor kinect do xbox 360 (Kinect v1) para adquirir imagens RGB e mapa de profundidade. Usaremos a libfreenect (OpenKi...</p></div></div></a></div><div class="card"> <a href="/posts/como_contribuir/"><div class="card-body"> <em class="timeago small" date="2022-01-23 16:42:34 -0300" >Jan 23</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Como contribuir neste Blog</h3><div class="text-muted small"><p> Aprenda como enviar o seu tutorial em forma de artigo para o Blog oficial do Grupo OpenCV Brasil (apelidado carinhosamente de OpenCVismo Brasil). 1. Fork o repositório do Blog Acesse o repositóri...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/cap2/" class="btn btn-outline-primary" prompt="Newer"><p>Processamento Morfológico de Imagens</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Grupo OpenCV Brasil</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/getting-started/">getting started</a> <a class="post-tag" href="/tags/kinect-libfreenec-c/">kinect libfreenec c++</a> <a class="post-tag" href="/tags/vcpkg-windows-c/">vcpkg windows c++</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
